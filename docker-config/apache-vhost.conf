<VirtualHost *:80>
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/html

    <Directory /var/www/html>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    # Drupal clean URLs
    <IfModule mod_rewrite.c>
        RewriteEngine On
    </IfModule>

    # Set recommended PHP values
    <IfModule mod_php7.c>
        php_value memory_limit 256M
        php_value upload_max_filesize 32M
        php_value post_max_size 32M
        php_value max_execution_time 120
    </IfModule>

    # Pass environment variables to PHP
    PassEnv DRUPAL_DB_HOST
    PassEnv DRUPAL_DB_USER
    PassEnv DRUPAL_DB_PASSWORD
    PassEnv DRUPAL_DB_NAME
    PassEnv DRUPAL_HASH_SALT
    PassEnv BASE_URL
    PassEnv ENVIRONMENT
    # Also pass DB_* variables if they exist
    PassEnv DB_HOST
    PassEnv DB_NAME
    PassEnv DB_USER
    PassEnv DB_PASS
    PassEnv DB_PORT
    
    # Note: Environment variables are passed via PassEnv directives above
    # The entrypoint script will ensure they are available to Apache

    # Configure logging for CloudWatch
    # Available loglevels: trace8, ..., trace1, debug, info, notice, warn,
    # error, crit, alert, emerg.
    LogLevel warn
    ErrorLog /dev/stderr
    CustomLog /dev/stdout combined
</VirtualHost>
